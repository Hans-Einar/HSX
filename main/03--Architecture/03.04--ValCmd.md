# Architecture View â€” Value & Command Access Layer

## Role & Responsibilities
- Expose HSX app data points (values) for external observation/control.
- Provide zero-argument commands for mode switching, calibration, diagnostics.
- Bridge values/commands to shell, CAN, mailbox, and persistence layers.
- Offer a consistent interface for embedded telemetry and command workflows so domain apps remain hardware-agnostic.
- **Declarative registration**: Process `.value` and `.cmd` metadata sections from HXE format v2 during app load, eliminating runtime registration overhead.

## Interfaces
- **Declarative**: HXE metadata sections (`.value`, `.cmd`) processed by executive before VM execution.
- **Runtime (optional)**: SVC module 0x07 (values) and 0x08 (commands) for dynamic registration (primarily for testing/prototyping).
- Numeric addressing via group:value IDs with optional human-readable names.
- CAN/UART/mailbox bindings defined in [docs/hsx_value_interface.md](../../docs/hsx_value_interface.md).

## Relationships
- Values sourced from HSX tasks; executive mediates access and persistence.
- Commands trigger task-defined handlers; security enforced via flags/tokens.
- Tooling (shell, debugger, CAN gateways) rely on this layer for observability.
- Mailbox subsystem routes async events (subscriptions, command returns); scheduler depends on value updates to avoid busy polling.

## Notes
- Values are f16-based; bool represented as 0/1 to minimise footprint.
- Per-value metadata optional; runtime keeps compact records to save RAM.
- Persistence via FRAM or EEPROM keys enables calibration/state retention across power cycles.
- Design rationale (see [02--Study.md](../02--Study/02--Study.md)): embedded nodes often need to expose live telemetry and accept operational commands without reflashing firmware; consolidating values/commands across transport channels ensures consistency while keeping the runtime tiny (numeric IDs, optional descriptors). Future optimisations (arrays/matrices, hot paths) can build on this foundation if profiling warrants it.
