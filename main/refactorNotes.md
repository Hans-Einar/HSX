# Refactor Notes — Executive SVC Module

- Update all existing HSX payloads (pytest fixtures, examples, `.hxe` samples) to issue executive control traps through module `0x06` instead of the legacy `0x07` alias. Track progress alongside the transition plan captured in `docs/abi_syscalls.md`.
- Introduce a shared syscall definition header (e.g., `include/hsx_syscalls.h`) that enumerates module IDs and function selectors. The Python tooling should mirror the existing mailbox constant flow (`python/hsx_mailbox_constants.py`) by scraping the same header so module changes stay in sync across languages.
- Once the shared header is authoritative, replace hard-coded module/function literals in the Python prototype (`platforms/python/host_vm.py`, tests, and assembler helpers) with imports generated from that header.
- Add an executive module-version query (candidate `EXEC_GET_VERSION`) so payloads can confirm a module’s capability level before issuing traps. Pair this with the shared header so both native and Python sides agree on version constants.
- Update issue `issues/#2_scheduler` with the final scheduler contract extracted from `main/(4)design/(4.2)executive.md` so implementation work tracks against the documented design.
- Implement the debugger session/event streaming spec: add `session.open/keepalive/close`, `events.subscribe/unsubscribe/ack`, bounded event buffers, and the structured event payloads described in `main/(4)design/(4.2)executive.md` and `docs/executive_protocol.md`. Ensure `host_vm.py` emits the required event types (`debug_break`, `trace_step`, scheduler/mailbox) and add regression tests for back-pressure and reconnection behaviour.
- Rework existing executive endpoints to support the debugger contracts: enforce PID locks (one active debugger per PID), add `ps <pid>` filtering, surface stack/memory helpers, and route legacy `log_buffer`/scheduler trace signals through the new event bus so current polling clients continue to function.
\n- DO-4.b: Investigate FRAM-backed cache (DMA-like load from FRAM into AVR RAM cache) for future Stage 2, tracked under MiniVM implementation doc.
